{{ define "main" }}
<style>
/* ===== WRAPPER ===== */
.booking-wrapper {
  max-width: 600px;
  margin: 40px auto;
  padding: 0 16px 60px;
}
.booking-wrapper h2 {
  text-align: center;
  font-size: 1.6rem;
  margin-bottom: 6px;
}
.booking-wrapper p.subtitle {
  text-align: center;
  color: var(--secondary, #aaa);
  margin-bottom: 28px;
  font-size: 0.95rem;
}
.step-section {
  background: var(--entry, #1e1e1e);
  border-radius: 14px;
  padding: 24px;
  margin-bottom: 16px;
  box-shadow: 0 2px 16px rgba(0,0,0,0.25);
}
.step-title {
  font-size: 0.82rem;
  font-weight: 700;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: #4e8ef7;
  margin-bottom: 16px;
}

/* ===== CALENDAR ===== */
.cal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 14px;
}
.cal-header span {
  font-weight: 700;
  font-size: 1.05rem;
}
.cal-nav {
  background: none;
  border: 1px solid var(--border, #444);
  color: var(--primary, #ddd);
  width: 34px; height: 34px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 1.2rem;
  display: flex; align-items: center; justify-content: center;
  transition: background 0.15s;
  line-height: 1;
}
.cal-nav:hover:not(:disabled) { background: rgba(78,142,247,0.15); border-color: #4e8ef7; }
.cal-nav:disabled { opacity: 0.25; cursor: default; }
.cal-grid {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 3px;
}
.cal-day-label {
  text-align: center;
  font-size: 0.72rem;
  color: var(--secondary, #888);
  padding: 4px 0 8px;
  font-weight: 600;
}
.cal-day {
  aspect-ratio: 1;
  border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  font-size: 0.88rem;
  cursor: pointer;
  border: 1.5px solid transparent;
  transition: all 0.15s;
  user-select: none;
  position: relative;
}
.cal-day:hover:not(.cal-past):not(.cal-empty):not(.cal-full) {
  background: rgba(78,142,247,0.15);
  border-color: #4e8ef7;
}
.cal-day.cal-today { border-color: #4e8ef7; font-weight: 700; }
.cal-day.cal-selected { background: #4e8ef7 !important; border-color: #4e8ef7; color: white; font-weight: 700; }
.cal-day.cal-past, .cal-day.cal-empty { color: var(--secondary, #444); cursor: default; pointer-events: none; }
.cal-day.cal-full { color: var(--secondary, #555); cursor: default; pointer-events: none; text-decoration: line-through; opacity: 0.4; }
.cal-day.cal-has-booking::after {
  content: '';
  position: absolute;
  bottom: 3px; left: 50%;
  transform: translateX(-50%);
  width: 4px; height: 4px;
  border-radius: 50%;
  background: #4e8ef7;
}
.cal-day.cal-selected::after { background: white; }

/* ===== TIME SLOTS ===== */
.slots-placeholder {
  text-align: center;
  color: var(--secondary, #888);
  font-size: 0.9rem;
  padding: 16px 0;
}
.slots-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 8px;
}
.slot-btn {
  padding: 10px 4px 8px;
  border-radius: 10px;
  border: 1.5px solid var(--border, #444);
  background: var(--theme, #121212);
  color: var(--primary, #ddd);
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  text-align: center;
  transition: all 0.15s;
  line-height: 1.3;
}
.slot-btn:hover:not(:disabled) { border-color: #4e8ef7; background: rgba(78,142,247,0.12); }
.slot-btn.selected { background: #4e8ef7; border-color: #4e8ef7; color: white; }
.slot-btn:disabled { background: rgba(0,0,0,0.1); color: var(--secondary, #555); cursor: not-allowed; border-color: var(--border, #333); }
.slot-surcharge {
  display: block;
  font-size: 0.62rem;
  font-weight: 400;
  color: #ff9800;
  margin-top: 2px;
}
.slot-btn.selected .slot-surcharge { color: #ffe0a0; }
.slot-booked {
  display: block;
  font-size: 0.62rem;
  font-weight: 400;
  color: var(--secondary, #555);
  margin-top: 2px;
}

/* ===== FORM ===== */
.selected-summary {
  background: rgba(78,142,247,0.1);
  border: 1px solid rgba(78,142,247,0.3);
  border-radius: 10px;
  padding: 12px 16px;
  margin-bottom: 20px;
  font-size: 0.9rem;
  color: var(--primary, #ddd);
  line-height: 1.7;
}
.selected-summary strong { color: #4e8ef7; }
.surcharge-notice {
  display: inline-block;
  background: rgba(255,152,0,0.15);
  border: 1px solid rgba(255,152,0,0.4);
  color: #ff9800;
  border-radius: 6px;
  padding: 2px 8px;
  font-size: 0.8rem;
  font-weight: 600;
  margin-left: 6px;
}
.form-group { display: flex; flex-direction: column; margin-bottom: 16px; }
.form-group label { font-size: 0.88rem; font-weight: 600; margin-bottom: 6px; color: var(--primary, #ddd); }
.form-group input,
.form-group select,
.form-group textarea {
  width: 100%; padding: 10px 14px;
  border-radius: 8px; border: 1px solid var(--border, #444);
  background: var(--theme, #121212); color: var(--primary, #ddd);
  font-size: 1rem; box-sizing: border-box;
  transition: border-color 0.2s;
  appearance: none; -webkit-appearance: none;
}
.form-group select {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath fill='%23aaa' d='M6 8L0 0h12z'/%3E%3C/svg%3E");
  background-repeat: no-repeat; background-position: right 14px center; padding-right: 36px;
}
.form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: #4e8ef7; }
.form-group select:disabled { opacity: 0.5; cursor: not-allowed; }
.service-tag { display: inline-block; font-size: 0.72rem; padding: 2px 8px; border-radius: 99px; margin-left: 6px; vertical-align: middle; }
.tag-nail { background: #f3e5f5; color: #7b1fa2; }
.tag-lash { background: #e3f2fd; color: #1565c0; }
.submit-btn {
  width: 100%; padding: 13px; border-radius: 10px; border: none;
  background-color: #4e8ef7; color: white;
  font-size: 1.05rem; font-weight: 700; cursor: pointer; margin-top: 8px;
  transition: background-color 0.2s;
}
.submit-btn:hover { background-color: #3a7ae0; }
.submit-btn:disabled { background-color: #555; cursor: not-allowed; }
#form-status { text-align: center; margin-top: 14px; font-weight: bold; min-height: 24px; }
.form-step { display: none; }
.form-step.visible { display: block; }
</style>

<div class="booking-wrapper">
  <h2>ç·šä¸Šé ç´„</h2>
  <p class="subtitle">é¸æ“‡æ—¥æœŸèˆ‡æ™‚æ®µï¼Œå¡«å¯«è³‡æ–™å¾Œé€å‡ºé ç´„</p>

  <!-- â‘  é¸æ“‡æ—¥æœŸ -->
  <div class="step-section">
    <div class="step-title">â‘  é¸æ“‡æ—¥æœŸ</div>
    <div class="cal-header">
      <button class="cal-nav" id="cal-prev">â€¹</button>
      <span id="cal-title"></span>
      <button class="cal-nav" id="cal-next">â€º</button>
    </div>
    <div class="cal-grid" id="cal-grid"></div>
  </div>

  <!-- â‘¡ é¸æ“‡æ™‚æ®µ -->
  <div class="step-section">
    <div class="step-title">â‘¡ é¸æ“‡æ™‚æ®µ</div>
    <div id="slots-container">
      <div class="slots-placeholder">è«‹å…ˆé¸æ“‡æ—¥æœŸ</div>
    </div>
  </div>

  <!-- â‘¢ å¡«å¯«è³‡æ–™ï¼ˆé¸å®Œæ™‚æ®µæ‰é¡¯ç¤ºï¼‰ -->
  <div class="step-section form-step" id="form-step">
    <div class="step-title">â‘¢ å¡«å¯«é ç´„è³‡æ–™</div>
    <div class="selected-summary" id="selected-summary"></div>
    <form id="booking-form">
      <div class="form-group">
        <label for="name">å§“å</label>
        <input type="text" id="name" name="name" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å" required>
      </div>
      <div class="form-group">
        <label for="email">é›»å­éƒµä»¶</label>
        <input type="email" id="email" name="email" placeholder="example@email.com" required>
      </div>
      <div class="form-group">
        <label for="phone">è¯çµ¡é›»è©±</label>
        <input type="tel" id="phone" name="phone" placeholder="0912-345-678" required>
      </div>
      <div class="form-group">
        <label for="category">æœå‹™é¡åˆ¥</label>
        <select id="category" name="category" required>
          <option value="">è«‹é¸æ“‡æœå‹™é¡åˆ¥</option>
          <option value="nail">ğŸ’… ç¾ç”²</option>
          <option value="lash">âœ¨ ç¾ç«</option>
        </select>
      </div>
      <div class="form-group">
        <label for="service">
          æœå‹™é …ç›®
          <span id="service-tag" class="service-tag" style="display:none;"></span>
        </label>
        <select id="service" name="service" required disabled>
          <option value="">è«‹å…ˆé¸æ“‡æœå‹™é¡åˆ¥</option>
        </select>
      </div>
      <div class="form-group">
        <label for="notes">å‚™è¨»ï¼ˆé¸å¡«ï¼‰</label>
        <textarea id="notes" name="notes" rows="3" placeholder="å¦‚æœ‰ç‰¹æ®Šéœ€æ±‚ã€åƒè€ƒåœ–ç‰‡é€£çµç­‰è«‹åœ¨æ­¤èªªæ˜"></textarea>
      </div>
      <button type="submit" class="submit-btn">é€å‡ºé ç´„</button>
      <div id="form-status"></div>
    </form>
  </div>
</div>

<!-- EmailJS SDK -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script>
// =====================================================
// â˜… è¨­å®šå€
// =====================================================
const EMAILJS_PUBLIC_KEY  = "ydXq_gMt59U_Zfwz9";
const EMAILJS_SERVICE_ID  = "service_4qxqcjt";
const EMAILJS_TEMPLATE_ID = "template_jsrd2gm";
const APPS_SCRIPT_URL     = "YOUR_APPS_SCRIPT_URL"; // â† éƒ¨ç½² Apps Script å¾Œå¡«å…¥

// ç‡Ÿæ¥­è¨­å®š
const OPEN_HOUR        = 8;    // é–‹å§‹æ™‚é–“
const CLOSE_HOUR       = 20;   // çµæŸæ™‚é–“ï¼ˆæœ€å¾Œæ™‚æ®µåœ¨ 19:00 é–‹å§‹ï¼‰
const SLOT_MINS        = 60;   // æ¯æ™‚æ®µåˆ†é˜æ•¸
const SURCHARGE_HOUR   = 19;   // å¹¾é»ï¼ˆå«ï¼‰ä»¥å¾ŒåŠ æ”¶è²»ç”¨
const SURCHARGE_AMOUNT = 200;  // åŠ æ”¶é‡‘é¡ NT$
// =====================================================

emailjs.init(EMAILJS_PUBLIC_KEY);

// æœå‹™é …ç›®
const SERVICES = {
  nail: {
    label: "ç¾ç”²", tagClass: "tag-nail",
    items: ["å‡è† æŒ‡ç”²ï¼ˆç´ è‰²ï¼‰","å‡è† æŒ‡ç”²ï¼ˆè¨­è¨ˆæ¬¾ï¼‰","å…‰ç™‚æŒ‡ç”²","å»¶ç”²","å¸ç”²"]
  },
  lash: {
    label: "ç¾ç«", tagClass: "tag-lash",
    items: ["è‡ªç„¶æ¬¾ï¼ˆå–®æ ¹å«æ¥ï¼‰","è¤‡åˆæ¬¾","æ¿ƒå¯†æ¬¾ï¼ˆèŠ±æŸç«æ¯›ï¼‰","è£œç«æ¯›","å¸é™¤ç«æ¯›"]
  }
};

// ç”¢ç”Ÿæ‰€æœ‰æ™‚æ®µ
function generateSlots() {
  const slots = [];
  for (let h = OPEN_HOUR; h < CLOSE_HOUR; h++) {
    slots.push(`${String(h).padStart(2,'0')}:00`);
  }
  return slots;
}
const ALL_SLOTS = generateSlots(); // ["08:00","09:00",...,"19:00"]

// ===== ç‹€æ…‹ =====
let bookedSet = new Set();   // "YYYY-MM-DD_HH:MM"
let slotsReady = false;
let selectedDate = null;
let selectedTime = null;

const today = new Date();
today.setHours(0, 0, 0, 0);

// ===== è®€å–å·²é ç´„æ™‚æ®µ =====
async function loadBookedSlots() {
  if (!APPS_SCRIPT_URL || APPS_SCRIPT_URL === "YOUR_APPS_SCRIPT_URL") {
    slotsReady = true;
    return;
  }
  try {
    const res = await fetch(`${APPS_SCRIPT_URL}?action=getBooked`);
    const data = await res.json();
    bookedSet = new Set(data.booked || []);
  } catch (e) {
    console.warn("ç„¡æ³•è®€å–é ç´„ç´€éŒ„ï¼š", e);
  } finally {
    slotsReady = true;
    renderCalendar();
    if (selectedDate) renderTimeSlots(selectedDate);
  }
}

// ===== æ—¥æ›† =====
let calYear, calMonth;
function initCalendar() {
  calYear  = today.getFullYear();
  calMonth = today.getMonth();
  renderCalendar();
  document.getElementById("cal-prev").onclick = () => {
    calMonth--;
    if (calMonth < 0) { calMonth = 11; calYear--; }
    renderCalendar();
  };
  document.getElementById("cal-next").onclick = () => {
    calMonth++;
    if (calMonth > 11) { calMonth = 0; calYear++; }
    renderCalendar();
  };
}

function renderCalendar() {
  const prevBtn = document.getElementById("cal-prev");
  prevBtn.disabled = (calYear === today.getFullYear() && calMonth === today.getMonth());
  document.getElementById("cal-title").textContent = `${calYear} å¹´ ${calMonth + 1} æœˆ`;

  const grid = document.getElementById("cal-grid");
  grid.innerHTML = "";

  // æ˜ŸæœŸæ¨™é¡Œï¼ˆé€±ä¸€ç‚ºç¬¬ä¸€å¤©ï¼‰
  ["ä¸€","äºŒ","ä¸‰","å››","äº”","å…­","æ—¥"].forEach(d => {
    const el = document.createElement("div");
    el.className = "cal-day-label";
    el.textContent = d;
    grid.appendChild(el);
  });

  // ç©ºæ ¼è£œä½
  const firstDay = new Date(calYear, calMonth, 1);
  let offset = firstDay.getDay();
  offset = (offset === 0) ? 6 : offset - 1;
  for (let i = 0; i < offset; i++) {
    const el = document.createElement("div");
    el.className = "cal-day cal-empty";
    grid.appendChild(el);
  }

  // æ—¥æœŸæ ¼
  const daysInMonth = new Date(calYear, calMonth + 1, 0).getDate();
  for (let d = 1; d <= daysInMonth; d++) {
    const el = document.createElement("div");
    el.className = "cal-day";
    el.textContent = d;
    const dateStr = `${calYear}-${String(calMonth+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
    const dayDate = new Date(calYear, calMonth, d);

    if (dayDate < today) {
      el.classList.add("cal-past");
    } else {
      if (dayDate.getTime() === today.getTime()) el.classList.add("cal-today");

      // æ˜¯å¦å…¨æ»¿
      if (slotsReady) {
        const bookedCount = ALL_SLOTS.filter(s => bookedSet.has(`${dateStr}_${s}`)).length;
        if (bookedCount === ALL_SLOTS.length) {
          el.classList.add("cal-full");
        } else if (bookedCount > 0) {
          el.classList.add("cal-has-booking");
        }
      }

      if (dateStr === selectedDate) el.classList.add("cal-selected");
      el.onclick = () => selectDate(dateStr);
    }
    grid.appendChild(el);
  }
}

function selectDate(dateStr) {
  selectedDate = dateStr;
  selectedTime = null;
  renderCalendar();
  renderTimeSlots(dateStr);
  document.getElementById("form-step").classList.remove("visible");
}

// ===== æ™‚æ®µæ ¼ =====
function renderTimeSlots(dateStr) {
  const container = document.getElementById("slots-container");
  if (!slotsReady) {
    container.innerHTML = '<div class="slots-placeholder">è®€å–å¯ç”¨æ™‚æ®µä¸­â€¦</div>';
    return;
  }

  const grid = document.createElement("div");
  grid.className = "slots-grid";

  ALL_SLOTS.forEach(slot => {
    const btn = document.createElement("button");
    btn.type = "button";
    btn.className = "slot-btn";

    const hour       = parseInt(slot);
    const isBooked   = bookedSet.has(`${dateStr}_${slot}`);
    const isSurcharge = hour >= SURCHARGE_HOUR;

    btn.innerHTML = `<span>${slot}</span>`;

    if (isSurcharge) {
      const badge = document.createElement("span");
      badge.className = "slot-surcharge";
      badge.textContent = `+NT$${SURCHARGE_AMOUNT}`;
      btn.appendChild(badge);
    }

    if (isBooked) {
      btn.disabled = true;
      const label = document.createElement("span");
      label.className = "slot-booked";
      label.textContent = "å·²é ç´„";
      btn.appendChild(label);
    } else {
      if (slot === selectedTime) btn.classList.add("selected");
      btn.onclick = () => selectTime(slot, isSurcharge);
    }
    grid.appendChild(btn);
  });

  container.innerHTML = "";
  container.appendChild(grid);
}

function selectTime(slot, isSurcharge) {
  selectedTime = slot;
  renderTimeSlots(selectedDate);

  // æ›´æ–°æ‘˜è¦ä¸¦é¡¯ç¤ºè¡¨å–®
  const d = new Date(selectedDate + "T00:00:00");
  const dateDisplay = d.toLocaleDateString("zh-TW", {
    year: "numeric", month: "long", day: "numeric", weekday: "short"
  });

  let summaryHtml = `ğŸ“… <strong>${dateDisplay}</strong>&nbsp;&nbsp;ğŸ• <strong>${slot}</strong>`;
  if (isSurcharge) {
    summaryHtml += `<br><span class="surcharge-notice">âš ï¸ æ­¤æ™‚æ®µåŠ æ”¶ NT$${SURCHARGE_AMOUNT} åŠ ç­è²»</span>`;
  }
  document.getElementById("selected-summary").innerHTML = summaryHtml;

  const formStep = document.getElementById("form-step");
  formStep.classList.add("visible");
  setTimeout(() => formStep.scrollIntoView({ behavior: "smooth", block: "nearest" }), 50);
}

// ===== æœå‹™é¸å–® =====
document.getElementById("category").addEventListener("change", function () {
  const serviceSelect = document.getElementById("service");
  const tag = document.getElementById("service-tag");
  const val = this.value;

  if (val && SERVICES[val]) {
    const { label, tagClass, items } = SERVICES[val];
    serviceSelect.innerHTML = `<option value="">è«‹é¸æ“‡${label}é …ç›®</option>`;
    items.forEach(item => {
      const opt = document.createElement("option");
      opt.value = item; opt.textContent = item;
      serviceSelect.appendChild(opt);
    });
    serviceSelect.disabled = false;
    tag.textContent = label;
    tag.className = `service-tag ${tagClass}`;
    tag.style.display = "inline-block";
  } else {
    serviceSelect.innerHTML = "<option value=''>è«‹å…ˆé¸æ“‡æœå‹™é¡åˆ¥</option>";
    serviceSelect.disabled = true;
    tag.style.display = "none";
  }
});

// ===== é€å‡ºé ç´„ =====
document.getElementById("booking-form").addEventListener("submit", async function (e) {
  e.preventDefault();
  const statusDiv = document.getElementById("form-status");
  const submitBtn = this.querySelector(".submit-btn");

  if (!selectedDate || !selectedTime) {
    statusDiv.textContent = "è«‹å…ˆé¸æ“‡æ—¥æœŸèˆ‡æ™‚æ®µï¼";
    statusDiv.style.color = "#f44336";
    return;
  }

  statusDiv.textContent = "å‚³é€ä¸­â€¦";
  statusDiv.style.color = "#4e8ef7";
  submitBtn.disabled = true;

  const name     = document.getElementById("name").value.trim();
  const email    = document.getElementById("email").value.trim();
  const phone    = document.getElementById("phone").value.trim();
  const catVal   = document.getElementById("category").value;
  const category = SERVICES[catVal]?.label || catVal;
  const service  = document.getElementById("service").value;
  const notes    = document.getElementById("notes").value.trim() || "ç„¡";
  const hour     = parseInt(selectedTime);
  const hasSurcharge = hour >= SURCHARGE_HOUR;
  const surchargeText = hasSurcharge ? `æ˜¯ï¼ˆ+NT$${SURCHARGE_AMOUNT}ï¼‰` : "å¦";

  // Google Calendar é€£çµ
  const startTime = new Date(`${selectedDate}T${selectedTime}:00`);
  const endTime   = new Date(startTime.getTime() + SLOT_MINS * 60 * 1000);
  const fmt = (d) => d.toISOString().replace(/[-:]/g, "").split(".")[0] + "Z";
  const gcalText    = encodeURIComponent(`é ç´„ ${category}ï¼š${name}`);
  const gcalDetails = encodeURIComponent(
    `æœå‹™ï¼š${category} - ${service}\nå§“åï¼š${name}\né›»è©±ï¼š${phone}\nä¿¡ç®±ï¼š${email}${hasSurcharge ? `\nâš ï¸ åŠ ç­è²»ï¼šNT$${SURCHARGE_AMOUNT}` : ''}\nå‚™è¨»ï¼š${notes}`
  );
  const gcalLink = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${gcalText}&dates=${fmt(startTime)}/${fmt(endTime)}&details=${gcalDetails}`;

  const dateDisplay = new Date(`${selectedDate}T00:00:00`).toLocaleDateString("zh-TW", {
    year: "numeric", month: "long", day: "numeric", weekday: "short"
  });

  // 1. å¯«å…¥ Google Sheets
  if (APPS_SCRIPT_URL && APPS_SCRIPT_URL !== "YOUR_APPS_SCRIPT_URL") {
    try {
      const params = new URLSearchParams({
        action: "book",
        date: selectedDate, time: selectedTime,
        name, phone, email, category, service, notes
      });
      const res  = await fetch(`${APPS_SCRIPT_URL}?${params}`);
      const data = await res.json();
      if (data.success) {
        bookedSet.add(`${selectedDate}_${selectedTime}`);
        renderCalendar(); // é‡æ–°æ¸²æŸ“ï¼ˆå¯èƒ½è®Šå…¨æ»¿ï¼‰
      }
    } catch (err) {
      console.warn("Google Sheets å¯«å…¥å¤±æ•—ï¼š", err);
    }
  }

  // 2. EmailJS é€šçŸ¥
  try {
    await emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, {
      name, email, phone, category, service,
      date: dateDisplay, time: selectedTime,
      surcharge: surchargeText,
      notes, gcal_link: gcalLink,
    });

    statusDiv.innerHTML = "âœ… é ç´„ç”³è«‹å·²é€å‡ºï¼æˆ‘å€‘æœƒç›¡å¿«èˆ‡æ‚¨ç¢ºèªã€‚";
    statusDiv.style.color = "#4caf50";
    this.reset();
    document.getElementById("service").disabled = true;
    document.getElementById("service-tag").style.display = "none";
    selectedTime = null;
    renderTimeSlots(selectedDate);
    document.getElementById("form-step").classList.remove("visible");
  } catch (err) {
    console.error("EmailJS ç™¼é€å¤±æ•—ï¼š", err);
    statusDiv.textContent = "å‚³é€å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚";
    statusDiv.style.color = "#f44336";
  } finally {
    submitBtn.disabled = false;
  }
});

// ===== åˆå§‹åŒ– =====
initCalendar();
loadBookedSlots();
</script>
{{ end }}
